CREATE TABLE PROVINCIAS(
 ID_PROVINCIA INT(3) PRIMARY KEY,
 NOMBRE VARCHAR(50)
);

CREATE TABLE MUNICIPIOS(
 ID_MUNICIPIO INT(3) PRIMARY KEY AUTO_INCREMENT,
 NOMBRE VARCHAR(50),
 DESCRIPCION VARCHAR(5000),
 COD_MUNICIPIO INT(3),
 ID_PROVINCIA INT(3),
 FOREIGN KEY (ID_PROVINCIA) REFERENCES PROVINCIAS (ID_PROVINCIA) ON DELETE SET NULL
);

CREATE TABLE ESPACIOS_NATURALES(
 ID_ESPACIO INT(3) PRIMARY KEY AUTO_INCREMENT,
 NOMBRE VARCHAR(50),
 DESCRIPCION VARCHAR(5000),
 TIPO VARCHAR(50),
 CATEGORIA VARCHAR(50),
 LATITUD DOUBLE (20,16),
 LONGITUD DOUBLE (20,16)
);

CREATE TABLE MUNICIPIOS_ESPACIOS_NAT(
 ID_ESPACIO INT(3) NOT NULL,
 ID_MUNICIPIO INT(3) NOT NULL,
 FOREIGN KEY (ID_ESPACIO) REFERENCES ESPACIOS_NATURALES (ID_ESPACIO) ON DELETE CASCADE,
 FOREIGN KEY (ID_MUNICIPIO) REFERENCES MUNICIPIOS (ID_MUNICIPIO) ON DELETE CASCADE
) ENGINE=INNODB;

CREATE TABLE CENTROS_METEOROLOGICOS(
 ID_CENTRO_MET INT(3) PRIMARY KEY AUTO_INCREMENT,
 NOMBRE VARCHAR(50), 
 ID_MUNICIPIO INT(3),
 DIRECCION VARCHAR(80),
 LATITUD DOUBLE (20,16),
 LONGITUD DOUBLE (20,16),
 URL VARCHAR(150),
 HASH VARCHAR(64),
 FOREIGN KEY (ID_MUNICIPIO) REFERENCES MUNICIPIOS (ID_MUNICIPIO) ON DELETE SET NULL
 );

CREATE TABLE MEDICIONES_CENTRO_MET(
 ID_CENTRO_MET INT(3),
 FECHA DATE,
 HORA TIME(2),
 DIR_VIENTO INT(4),
 H_RELATIVA INT(3),
 P_ATMOSFERICA FLOAT (6,2),
 PRECIP FLOAT (5,2),
 RAD_SOLAR FLOAT (6,2),
 TEMP_AMBIENTE FLOAT (4,2),
 V_VIENTO FLOAT (5,2), 
 ICA VARCHAR(50),
 FOREIGN KEY (ID_CENTRO_MET) REFERENCES CENTROS_METEOROLOGICOS (ID_CENTRO_MET) ON DELETE CASCADE,
 PRIMARY KEY (ID_CENTRO_MET, FECHA, HORA)
);

CREATE TABLE FUENTES(
 ID INT(3) PRIMARY KEY,
 FORMATO VARCHAR(5), 
 NOMBRE VARCHAR(50),
 URL VARCHAR(150),
 HASH VARCHAR(64)
);

CREATE TABLE CLIENTES(
 ID_CLIENTE INT(3) PRIMARY KEY AUTO_INCREMENT,
 USUARIO VARCHAR(30),
 PASSWD VARCHAR(30)
);

CREATE TABLE FOTOS(
 ID_FOTO VARCHAR(40) PRIMARY KEY,
 ID_CLIENTE INT(3),
 ID_ESPACIO INT(3),
 FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTES (ID_CLIENTE) ON DELETE CASCADE,
 FOREIGN KEY (ID_ESPACIO) REFERENCES ESPACIOS_NATURALES (ID_ESPACIO) ON DELETE CASCADE
);

CREATE TABLE FAVORITOS(
 ID_FAVORITO INT (3) PRIMARY KEY AUTO_INCREMENT,
 ID_CLIENTE INT(3),
 ID_ESPACIO INT(3),
 FAVORITO BOOLEAN,
 FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTES (ID_CLIENTE) ON DELETE CASCADE,
 FOREIGN KEY (ID_ESPACIO) REFERENCES ESPACIOS_NATURALES (ID_ESPACIO) ON DELETE CASCADE
);

